"use strict";(globalThis.webpackChunkrs_clone=globalThis.webpackChunkrs_clone||[]).push([[221],{9221:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var l=n(885),a=n(7294),r=n(9250),u=n(8013),i=n(5794),o=n(6297),c=n(5858),s=n(3611),d=n(807);function m(e){var t=e.avatarData,n=e.isLoggedUserProfile,r=(0,a.useState)(!1),o=(0,l.Z)(r,2),c=o[0],m=o[1],f=(0,a.useContext)(u.Z).user,p=null==t?void 0:t.imagePath,v=(0,a.useState)(null==t?void 0:t.avatarSrc),g=(0,l.Z)(v,2),E=g[0],h=g[1];return a.createElement(a.Fragment,null,a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"150px",height:"150px",border:"1px solid black",borderRadius:"50%"},onClick:n?function(){return m(!0)}:void 0},a.createElement("img",{style:{width:"150px",height:"150px",borderRadius:"50%"},src:E||"./images/icons/profile.jpg",alt:"avatar"})),c?a.createElement(s.Z,{setShowModal:m,callback:function(e,t){p&&(0,d.Z)(p),(0,i.BA)(e,t,null==f?void 0:f.displayName),h(e),m(!1)},type:"avatar"}):null)}var f=n(5500),p=n(5732);function v(e){var t,n=e.loggedUserData,o=null===(t=(0,a.useContext)(p.Z))||void 0===t?void 0:t.firebase,c=(0,a.useContext)(u.Z).setUser,s=(0,a.useState)(!1),d=(0,l.Z)(s,2),m=d[0],v=d[1],g=(0,a.useState)(""),E=(0,l.Z)(g,2),h=E[0],y=E[1],x=(0,a.useState)(""),w=(0,l.Z)(x,2),b=w[0],C=w[1],Z=(0,a.useState)(""),S=(0,l.Z)(Z,2),k=S[0],I=S[1],N=(0,r.s0)();return a.createElement(a.Fragment,null,a.createElement("button",{onClick:function(){n&&(y(n.username),C(n.fullName)),v(!0)}},"Edit profile"),m?a.createElement("div",{className:"modal"},a.createElement("div",{className:"modal__inner"},k&&a.createElement("p",null,k),a.createElement("form",{style:{display:"flex",flexDirection:"column"},onSubmit:async function(e){e.preventDefault();var t=(0,f.v0)(o),l=await(0,i.$K)(h);l?I("That username is already taken, please try another!"):(0,i.Al)(h,b,null==n?void 0:n.docId).then((function(){t.currentUser&&(0,f.ck)(t.currentUser,{displayName:h}).then((function(){c(t.currentUser)})).then((function(){N("/".concat(h))}))})).catch((function(e){return console.log(e)})),console.log(l)}},a.createElement("label",null,"Username",a.createElement("input",{type:"text",defaultValue:null==n?void 0:n.username,onChange:function(e){var t=e.target;return y(t.value.toLowerCase())}})),a.createElement("label",null,"Full Name",a.createElement("input",{type:"text",defaultValue:null==n?void 0:n.fullName,onChange:function(e){var t=e.target;return C(t.value)}})),a.createElement("button",{type:"submit"},"Edit"),a.createElement("button",{onClick:function(){n&&(y(n.username),C(n.fullName)),v(!1)}},"Close")))):null)}function g(e){var t=e.user,n=e.followersCount,r=e.setFollowersCount,o=(0,a.useContext)(u.Z).user,c=function(e){var t=(0,a.useState)(null),n=(0,l.Z)(t,2),r=n[0],u=n[1];return(0,a.useEffect)((function(){e&&async function(e){var t=await(0,i.xD)(e);u(t||{})}(e)}),[e]),r}(null==o?void 0:o.uid),s=t.username,d=t.avatarData,f=t.userId,p=t.docId,g=t.following,E=(0,a.useState)(!1),h=(0,l.Z)(E,2),y=h[0],x=h[1],w=!!o&&o.displayName==s;return(0,a.useEffect)((function(){!async function(){if(!w&&null!=o&&o.displayName&&f){var e=await(0,i.Fo)(o.displayName,f);x(e)}}()}),[null==o?void 0:o.displayName,f]),a.createElement("div",{style:{display:"flex"}},a.createElement(m,{isLoggedUserProfile:w,avatarData:d||null}),a.createElement("div",null,a.createElement("h4",null,s),w?a.createElement(v,{loggedUserData:c}):a.createElement("button",{onClick:function(){x(!y),r(y?n-1:n+1),(0,i.Gm)(y,f,p,null==c?void 0:c.userId,null==c?void 0:c.docId)}},y?"Unfollow":"Follow"),a.createElement("div",{style:{display:"flex",gap:"1em"}},a.createElement("p",null,0," - Publication"),a.createElement("p",null,n," - Followers"),a.createElement("p",null,g.length," - Followings"))))}var E=n(7238);const h=function(e){var t=e.photo,n=e.user,l=function(e){arguments.length>1&&void 0!==arguments[1]||navigator.language;var t=Math.round((e-Date.now())/1e3);if(Math.abs(t)>259200)return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});var n=[60,3600,86400,604800],l=["second","minute","hour","day"],a=n.findIndex((function(e){return e>Math.abs(t)})),r=a?n[a-1]:1,u=new Intl.RelativeTimeFormat("en",{});return u.format(Math.floor(t/r),l[a])}(t.dateCreated,"en");return a.createElement("div",{style:{maxWidth:"33%"}},a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},a.createElement(E.Z,{user:n}),a.createElement("div",{style:{fontSize:"50px",alignSelf:"flex-start",lineHeight:"17px"}},"...")),a.createElement("div",null,a.createElement("img",{src:t.imageSrc,style:{width:293,height:293}})),a.createElement("div",{style:{display:"flex",gap:"20px",alignItems:"center"}},a.createElement("div",{style:{background:'url("./images/icons/notifications.svg") no-repeat',width:"26px",height:"26px"}}),a.createElement("div",null,0!==t.likes.length&&a.createElement("span",null,t.likes.length," ",1===t.likes.length?"like":"likes"))),a.createElement("div",null,t.caption),a.createElement("div",null,l),a.createElement("div",null,a.createElement("span",null,"Комментарий"),a.createElement("span",null,"Комментарий")),a.createElement("div",null,a.createElement("input",{placeholder:"Add a comment"}),a.createElement("button",null,"Post")))};function y(e){var t=e.user,n=(0,a.useState)([]),r=(0,l.Z)(n,2),u=r[0],o=r[1],c=(0,a.useState)([]),s=(0,l.Z)(c,2),d=s[0],m=s[1],f=(0,a.useState)(null),p=(0,l.Z)(f,2),v=p[0],E=p[1],y=(0,a.useState)(0),x=(0,l.Z)(y,2),w=x[0],b=x[1];return(0,a.useEffect)((function(){m(t?function(e,t){return e.filter((function(e){return e.userId===t})).sort((function(e,t){return t.dateCreated-e.dateCreated}))}(u,t.userId):[])}),[u]),(0,a.useEffect)((function(){!async function(){t&&(E(t),b(t.followers.length),(0,i.Vv)().then((function(e){o(e)})).catch((function(e){o([])})))}()}),[null==t?void 0:t.username]),a.createElement("div",null,v?a.createElement(g,{user:v,followersCount:w,setFollowersCount:b}):null,a.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"20px"}},v?d.map((function(e,t){return a.createElement("div",{key:t},a.createElement(h,{photo:e,user:v}))})):null))}var x=n(3379),w=n.n(x),b=n(3017);function C(){var e=(0,r.s0)(),t=(0,r.UO)().username,n=(0,a.useContext)(u.Z).user,s=(0,a.useState)(null),d=(0,l.Z)(s,2),m=d[0],f=d[1];return(0,a.useEffect)((function(){document.title="Instagram - ".concat(t)}),[t]),(0,a.useEffect)((function(){null===n&&e(o.ym)}),[n]),(0,a.useEffect)((function(){!async function(){var n=await(0,i.dQ)(null==t?void 0:t.toLowerCase());null!=n&&n.userId?f(n):e(o.Hi)}()}),[t,e]),a.createElement("main",{className:"main-page"},a.createElement(c.Z,{isMainPage:!1}),a.createElement(y,{user:m}))}w()(b.Z,{insert:"head",singleton:!1}),b.Z.locals},3017:(e,t,n)=>{n.d(t,{Z:()=>r});var l=n(3645),a=n.n(l)()((function(e){return e[1]}));a.push([e.id,'.main-page{display:flex;flex-direction:column;min-height:100vh;margin-left:245px}@media screen and (max-width: 767px){.main-page{position:relative;margin-left:0;padding-top:61px}.main-page::before{content:"";position:absolute;top:60px;width:100%;height:1px;background-color:rgb(var(--secondary-bg_700))}}',""]);const r=a}}]);